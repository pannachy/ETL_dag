# ETL_dag

### Задача
на выходе будет DAG в airflow, который будет считаться каждый день за вчера. 

1. Параллельно нужно обрабатывать две таблицы. В feed_actions для каждого юзера нужно посчитать число просмотров и лайков контента. В message_actions для каждого юзера нужно посчитать, сколько он получает и отсылает сообщений, скольким людям он пишет, сколько людей пишут ему.

2. Объединить две таблицы в одну.

3. Для новой таблицы посчитать все вышеуказанные метрики в разрезе по полу, возрасту и ос.

4. И финальные данные со всеми метриками записать в отдельную таблицу в ClickHouse.

5. Каждый день таблица должна дополняться новыми данными. 

### Используемые инструменты
Python, Airflow, clickhouse

### Рабочие файлы

ETL_DAG.py - скрипт дага

graph_etl.jpg - снимок графа дага

db_examlple.jpg - снимок результата выгрузки в базу данных
